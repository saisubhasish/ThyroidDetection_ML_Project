[ 2023-01-20 20:28:39,803 ] 17 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Data Ingestion <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-20 20:28:39,804 ] 28 root - INFO - Exporting collection data as pandas dataframe
[ 2023-01-20 20:28:39,804 ] 22 root - INFO - Reading data from database: HealthCare and collection: Thyroid
[ 2023-01-20 20:28:39,956 ] 24 root - INFO - Found columns: Index(['_id', 'age', 'sex', 'on thyroxine', 'query on thyroxine',
       'on antithyroid medication', 'sick', 'pregnant', 'thyroid surgery',
       'I131 treatment', 'query hypothyroid', 'query hyperthyroid', 'lithium',
       'goitre', 'tumor', 'hypopituitary', 'psych', 'TSH measured', 'TSH',
       'T3 measured', 'T3', 'TT4 measured', 'TT4', 'T4U measured', 'T4U',
       'FTI measured', 'FTI', 'TBG measured', 'TBG', 'referral source',
       'binaryClass'],
      dtype='object')
[ 2023-01-20 20:28:39,956 ] 26 root - INFO - Dropping column: _id 
[ 2023-01-20 20:28:39,959 ] 28 root - INFO - Row and columns in df: (3772, 30)
[ 2023-01-20 20:28:39,959 ] 34 root - INFO - Replacing '?' value to np.NAN
[ 2023-01-20 20:28:39,964 ] 39 root - INFO - Save data in feature store
[ 2023-01-20 20:28:39,964 ] 41 root - INFO - Create feature store folder if not available
[ 2023-01-20 20:28:39,964 ] 45 root - INFO - Save df to feature store folder
[ 2023-01-20 20:28:40,005 ] 50 root - INFO - split dataset into train and test set
[ 2023-01-20 20:28:40,010 ] 54 root - INFO - create dataset directory folder if not available
[ 2023-01-20 20:28:40,010 ] 59 root - INFO - Saving train df and test df to dataset folder
[ 2023-01-20 20:28:40,045 ] 71 root - INFO - Data ingestion artifact: DataIngestionArtifact(feature_store_file_path='/config/workspace/artifact/01202023__202839/data_ingestion/feature_store/thyroid.csv', train_file_path='/config/workspace/artifact/01202023__202839/data_ingestion/dataset/train.csv', test_file_path='/config/workspace/artifact/01202023__202839/data_ingestion/dataset/test.csv')
[ 2023-01-20 20:28:40,047 ] 20 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Data Validation <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-20 20:28:40,048 ] 131 root - INFO - Reading base dataframe
[ 2023-01-20 20:28:40,085 ] 134 root - INFO - Replace ? value in base df
[ 2023-01-20 20:28:40,085 ] 136 root - INFO - Drop null values colums from base df
[ 2023-01-20 20:28:40,102 ] 42 root - INFO - selecting column name which contains null above to 0.2
[ 2023-01-20 20:28:40,103 ] 45 root - INFO - Columns to drop: ['T3', 'TBG']
[ 2023-01-20 20:28:40,104 ] 139 root - INFO - Reading train dataframe
[ 2023-01-20 20:28:40,116 ] 141 root - INFO - Reading test dataframe
[ 2023-01-20 20:28:40,121 ] 144 root - INFO - Drop null values colums from train df
[ 2023-01-20 20:28:40,132 ] 42 root - INFO - selecting column name which contains null above to 0.2
[ 2023-01-20 20:28:40,133 ] 45 root - INFO - Columns to drop: ['T3', 'TBG']
[ 2023-01-20 20:28:40,134 ] 146 root - INFO - Drop null values colums from test df
[ 2023-01-20 20:28:40,138 ] 42 root - INFO - selecting column name which contains null above to 0.2
[ 2023-01-20 20:28:40,138 ] 45 root - INFO - Columns to drop: ['T3', 'TBG']
[ 2023-01-20 20:28:40,139 ] 149 root - INFO - Drop unnecessary columns from base df
[ 2023-01-20 20:28:40,139 ] 67 root - INFO - UnnecessaColumns dropped: ['TSH measured', 'T3 measured', 'TT4 measured', 'T4U measured', 'FTI measured', 'TBG measured']
[ 2023-01-20 20:28:40,141 ] 151 root - INFO - Drop unnecessary columns from train df
[ 2023-01-20 20:28:40,141 ] 67 root - INFO - UnnecessaColumns dropped: ['TSH measured', 'T3 measured', 'TT4 measured', 'T4U measured', 'FTI measured', 'TBG measured']
[ 2023-01-20 20:28:40,143 ] 153 root - INFO - Drop unnecessary columns from test df
[ 2023-01-20 20:28:40,143 ] 67 root - INFO - UnnecessaColumns dropped: ['TSH measured', 'T3 measured', 'TT4 measured', 'T4U measured', 'FTI measured', 'TBG measured']
[ 2023-01-20 20:28:40,144 ] 156 root - INFO - Is all required columns present in train df
[ 2023-01-20 20:28:40,144 ] 158 root - INFO - Is all required columns present in test df
[ 2023-01-20 20:28:40,145 ] 162 root - INFO - As all column are available in train df hence detecting data drift in train dataframe
[ 2023-01-20 20:28:40,145 ] 111 root - INFO - Checking Data Types of age: object, float64 
[ 2023-01-20 20:28:40,148 ] 118 root - INFO - Checking number of classes in in age column
: (59     95
60     91
70     90
73     81
55     81
       ..
10      1
4       1
5       1
455     1
6       1
Name: age, Length: 93, dtype: int64, 59.0    82
60.0    72
63.0    69
73.0    68
70.0    66
        ..
5.0      1
6.0      1
93.0     1
94.0     1
4.0      1
Name: age, Length: 92, dtype: int64)
[ 2023-01-20 20:28:40,150 ] 111 root - INFO - Checking Data Types of sex: object, object 
[ 2023-01-20 20:28:40,152 ] 118 root - INFO - Checking number of classes in in sex column
: (F    2480
M    1142
Name: sex, dtype: int64, F    1978
M     916
Name: sex, dtype: int64)
[ 2023-01-20 20:28:40,153 ] 111 root - INFO - Checking Data Types of on thyroxine: object, object 
[ 2023-01-20 20:28:40,155 ] 118 root - INFO - Checking number of classes in in on thyroxine column
: (f    3308
t     464
Name: on thyroxine, dtype: int64, f    2652
t     365
Name: on thyroxine, dtype: int64)
[ 2023-01-20 20:28:40,156 ] 111 root - INFO - Checking Data Types of query on thyroxine: object, object 
[ 2023-01-20 20:28:40,157 ] 118 root - INFO - Checking number of classes in in query on thyroxine column
: (f    3722
t      50
Name: query on thyroxine, dtype: int64, f    2978
t      39
Name: query on thyroxine, dtype: int64)
[ 2023-01-20 20:28:40,159 ] 111 root - INFO - Checking Data Types of on antithyroid medication: object, object 
[ 2023-01-20 20:28:40,160 ] 118 root - INFO - Checking number of classes in in on antithyroid medication column
: (f    3729
t      43
Name: on antithyroid medication, dtype: int64, f    2982
t      35
Name: on antithyroid medication, dtype: int64)
[ 2023-01-20 20:28:40,161 ] 111 root - INFO - Checking Data Types of sick: object, object 
[ 2023-01-20 20:28:40,163 ] 118 root - INFO - Checking number of classes in in sick column
: (f    3625
t     147
Name: sick, dtype: int64, f    2899
t     118
Name: sick, dtype: int64)
[ 2023-01-20 20:28:40,164 ] 111 root - INFO - Checking Data Types of pregnant: object, object 
[ 2023-01-20 20:28:40,166 ] 118 root - INFO - Checking number of classes in in pregnant column
: (f    3719
t      53
Name: pregnant, dtype: int64, f    2978
t      39
Name: pregnant, dtype: int64)
[ 2023-01-20 20:28:40,167 ] 111 root - INFO - Checking Data Types of thyroid surgery: object, object 
[ 2023-01-20 20:28:40,169 ] 118 root - INFO - Checking number of classes in in thyroid surgery column
: (f    3719
t      53
Name: thyroid surgery, dtype: int64, f    2979
t      38
Name: thyroid surgery, dtype: int64)
[ 2023-01-20 20:28:40,170 ] 111 root - INFO - Checking Data Types of I131 treatment: object, object 
[ 2023-01-20 20:28:40,171 ] 118 root - INFO - Checking number of classes in in I131 treatment column
: (f    3713
t      59
Name: I131 treatment, dtype: int64, f    2970
t      47
Name: I131 treatment, dtype: int64)
[ 2023-01-20 20:28:40,172 ] 111 root - INFO - Checking Data Types of query hypothyroid: object, object 
[ 2023-01-20 20:28:40,174 ] 118 root - INFO - Checking number of classes in in query hypothyroid column
: (f    3538
t     234
Name: query hypothyroid, dtype: int64, f    2833
t     184
Name: query hypothyroid, dtype: int64)
[ 2023-01-20 20:28:40,175 ] 111 root - INFO - Checking Data Types of query hyperthyroid: object, object 
[ 2023-01-20 20:28:40,177 ] 118 root - INFO - Checking number of classes in in query hyperthyroid column
: (f    3535
t     237
Name: query hyperthyroid, dtype: int64, f    2825
t     192
Name: query hyperthyroid, dtype: int64)
[ 2023-01-20 20:28:40,178 ] 111 root - INFO - Checking Data Types of lithium: object, object 
[ 2023-01-20 20:28:40,180 ] 118 root - INFO - Checking number of classes in in lithium column
: (f    3754
t      18
Name: lithium, dtype: int64, f    3003
t      14
Name: lithium, dtype: int64)
[ 2023-01-20 20:28:40,181 ] 111 root - INFO - Checking Data Types of goitre: object, object 
[ 2023-01-20 20:28:40,183 ] 118 root - INFO - Checking number of classes in in goitre column
: (f    3738
t      34
Name: goitre, dtype: int64, f    2991
t      26
Name: goitre, dtype: int64)
[ 2023-01-20 20:28:40,184 ] 111 root - INFO - Checking Data Types of tumor: object, object 
[ 2023-01-20 20:28:40,185 ] 118 root - INFO - Checking number of classes in in tumor column
: (f    3676
t      96
Name: tumor, dtype: int64, f    2940
t      77
Name: tumor, dtype: int64)
[ 2023-01-20 20:28:40,187 ] 111 root - INFO - Checking Data Types of hypopituitary: object, object 
[ 2023-01-20 20:28:40,188 ] 118 root - INFO - Checking number of classes in in hypopituitary column
: (f    3771
t       1
Name: hypopituitary, dtype: int64, f    3016
t       1
Name: hypopituitary, dtype: int64)
[ 2023-01-20 20:28:40,189 ] 111 root - INFO - Checking Data Types of psych: object, object 
[ 2023-01-20 20:28:40,191 ] 118 root - INFO - Checking number of classes in in psych column
: (f    3588
t     184
Name: psych, dtype: int64, f    2867
t     150
Name: psych, dtype: int64)
[ 2023-01-20 20:28:40,192 ] 111 root - INFO - Checking Data Types of TSH: object, float64 
[ 2023-01-20 20:28:40,195 ] 118 root - INFO - Checking number of classes in in TSH column
: (0.2     116
1.3     105
1.1      97
1.4      91
1.5      80
       ... 
86        1
18.4      1
89        1
29        1
40        1
Name: TSH, Length: 287, dtype: int64, 0.2      98
1.3      84
1.1      75
1.4      72
1.6      68
         ..
30.0      1
400.0     1
40.0      1
70.0      1
7.7       1
Name: TSH, Length: 277, dtype: int64)
[ 2023-01-20 20:28:40,196 ] 111 root - INFO - Checking Data Types of TT4: object, float64 
[ 2023-01-20 20:28:40,199 ] 118 root - INFO - Checking number of classes in in TT4 column
: (101    71
93     67
98     63
103    63
102    59
       ..
289     1
240     1
43      1
34      1
258     1
Name: TT4, Length: 241, dtype: int64, 101.0    63
93.0     55
103.0    55
98.0     54
87.0     50
         ..
23.0      1
372.0     1
28.0      1
257.0     1
246.0     1
Name: TT4, Length: 230, dtype: int64)
[ 2023-01-20 20:28:40,200 ] 111 root - INFO - Checking Data Types of T4U: object, float64 
[ 2023-01-20 20:28:40,203 ] 118 root - INFO - Checking number of classes in in T4U column
: (0.99    95
0.9     93
1.01    91
1       90
0.92    89
        ..
1.84     1
0.57     1
2.03     1
1.97     1
0.25     1
Name: T4U, Length: 146, dtype: int64, 0.92    82
0.97    71
0.93    71
0.99    71
1.00    69
        ..
1.71     1
1.58     1
0.36     1
1.57     1
2.32     1
Name: T4U, Length: 139, dtype: int64)
[ 2023-01-20 20:28:40,204 ] 111 root - INFO - Checking Data Types of FTI: object, float64 
[ 2023-01-20 20:28:40,207 ] 118 root - INFO - Checking number of classes in in FTI column
: (100    73
93     70
114    65
98     64
107    64
       ..
349     1
221     1
187     1
39      1
227     1
Name: FTI, Length: 234, dtype: int64, 100.0    65
114.0    54
93.0     53
104.0    52
107.0    51
         ..
349.0     1
5.4       1
281.0     1
253.0     1
232.0     1
Name: FTI, Length: 219, dtype: int64)
[ 2023-01-20 20:28:40,208 ] 111 root - INFO - Checking Data Types of referral source: object, object 
[ 2023-01-20 20:28:40,210 ] 118 root - INFO - Checking number of classes in in referral source column
: (other    2201
SVI      1034
SVHC      386
STMW      112
SVHD       39
Name: referral source, dtype: int64, other    1752
SVI       845
SVHC      306
STMW       82
SVHD       32
Name: referral source, dtype: int64)
[ 2023-01-20 20:28:40,211 ] 111 root - INFO - Checking Data Types of binaryClass: object, object 
[ 2023-01-20 20:28:40,213 ] 118 root - INFO - Checking number of classes in in binaryClass column
: (P    3481
N     291
Name: binaryClass, dtype: int64, P    2784
N     233
Name: binaryClass, dtype: int64)
[ 2023-01-20 20:28:40,214 ] 165 root - INFO - As all column are available in test df hence detecting data drift test dataframe
[ 2023-01-20 20:28:40,214 ] 111 root - INFO - Checking Data Types of age: object, int64 
[ 2023-01-20 20:28:40,216 ] 118 root - INFO - Checking number of classes in in age column
: (59     95
60     91
70     90
73     81
55     81
       ..
10      1
4       1
5       1
455     1
6       1
Name: age, Length: 93, dtype: int64, 70    24
60    19
68    18
37    18
72    17
      ..
90     1
2      1
7      1
13     1
86     1
Name: age, Length: 85, dtype: int64)
[ 2023-01-20 20:28:40,217 ] 111 root - INFO - Checking Data Types of sex: object, object 
[ 2023-01-20 20:28:40,219 ] 118 root - INFO - Checking number of classes in in sex column
: (F    2480
M    1142
Name: sex, dtype: int64, F    502
M    226
Name: sex, dtype: int64)
[ 2023-01-20 20:28:40,220 ] 111 root - INFO - Checking Data Types of on thyroxine: object, object 
[ 2023-01-20 20:28:40,221 ] 118 root - INFO - Checking number of classes in in on thyroxine column
: (f    3308
t     464
Name: on thyroxine, dtype: int64, f    656
t     99
Name: on thyroxine, dtype: int64)
[ 2023-01-20 20:28:40,222 ] 111 root - INFO - Checking Data Types of query on thyroxine: object, object 
[ 2023-01-20 20:28:40,224 ] 118 root - INFO - Checking number of classes in in query on thyroxine column
: (f    3722
t      50
Name: query on thyroxine, dtype: int64, f    744
t     11
Name: query on thyroxine, dtype: int64)
[ 2023-01-20 20:28:40,225 ] 111 root - INFO - Checking Data Types of on antithyroid medication: object, object 
[ 2023-01-20 20:28:40,227 ] 118 root - INFO - Checking number of classes in in on antithyroid medication column
: (f    3729
t      43
Name: on antithyroid medication, dtype: int64, f    747
t      8
Name: on antithyroid medication, dtype: int64)
[ 2023-01-20 20:28:40,228 ] 111 root - INFO - Checking Data Types of sick: object, object 
[ 2023-01-20 20:28:40,229 ] 118 root - INFO - Checking number of classes in in sick column
: (f    3625
t     147
Name: sick, dtype: int64, f    726
t     29
Name: sick, dtype: int64)
[ 2023-01-20 20:28:40,230 ] 111 root - INFO - Checking Data Types of pregnant: object, object 
[ 2023-01-20 20:28:40,232 ] 118 root - INFO - Checking number of classes in in pregnant column
: (f    3719
t      53
Name: pregnant, dtype: int64, f    741
t     14
Name: pregnant, dtype: int64)
[ 2023-01-20 20:28:40,233 ] 111 root - INFO - Checking Data Types of thyroid surgery: object, object 
[ 2023-01-20 20:28:40,234 ] 118 root - INFO - Checking number of classes in in thyroid surgery column
: (f    3719
t      53
Name: thyroid surgery, dtype: int64, f    740
t     15
Name: thyroid surgery, dtype: int64)
[ 2023-01-20 20:28:40,235 ] 111 root - INFO - Checking Data Types of I131 treatment: object, object 
[ 2023-01-20 20:28:40,237 ] 118 root - INFO - Checking number of classes in in I131 treatment column
: (f    3713
t      59
Name: I131 treatment, dtype: int64, f    743
t     12
Name: I131 treatment, dtype: int64)
[ 2023-01-20 20:28:40,238 ] 111 root - INFO - Checking Data Types of query hypothyroid: object, object 
[ 2023-01-20 20:28:40,239 ] 118 root - INFO - Checking number of classes in in query hypothyroid column
: (f    3538
t     234
Name: query hypothyroid, dtype: int64, f    705
t     50
Name: query hypothyroid, dtype: int64)
[ 2023-01-20 20:28:40,240 ] 111 root - INFO - Checking Data Types of query hyperthyroid: object, object 
[ 2023-01-20 20:28:40,242 ] 118 root - INFO - Checking number of classes in in query hyperthyroid column
: (f    3535
t     237
Name: query hyperthyroid, dtype: int64, f    710
t     45
Name: query hyperthyroid, dtype: int64)
[ 2023-01-20 20:28:40,243 ] 111 root - INFO - Checking Data Types of lithium: object, object 
[ 2023-01-20 20:28:40,244 ] 118 root - INFO - Checking number of classes in in lithium column
: (f    3754
t      18
Name: lithium, dtype: int64, f    751
t      4
Name: lithium, dtype: int64)
[ 2023-01-20 20:28:40,245 ] 111 root - INFO - Checking Data Types of goitre: object, object 
[ 2023-01-20 20:28:40,246 ] 118 root - INFO - Checking number of classes in in goitre column
: (f    3738
t      34
Name: goitre, dtype: int64, f    747
t      8
Name: goitre, dtype: int64)
[ 2023-01-20 20:28:40,248 ] 111 root - INFO - Checking Data Types of tumor: object, object 
[ 2023-01-20 20:28:40,249 ] 118 root - INFO - Checking number of classes in in tumor column
: (f    3676
t      96
Name: tumor, dtype: int64, f    736
t     19
Name: tumor, dtype: int64)
[ 2023-01-20 20:28:40,250 ] 111 root - INFO - Checking Data Types of hypopituitary: object, object 
[ 2023-01-20 20:28:40,252 ] 118 root - INFO - Checking number of classes in in hypopituitary column
: (f    3771
t       1
Name: hypopituitary, dtype: int64, f    755
Name: hypopituitary, dtype: int64)
[ 2023-01-20 20:28:40,253 ] 111 root - INFO - Checking Data Types of psych: object, object 
[ 2023-01-20 20:28:40,255 ] 118 root - INFO - Checking number of classes in in psych column
: (f    3588
t     184
Name: psych, dtype: int64, f    721
t     34
Name: psych, dtype: int64)
[ 2023-01-20 20:28:40,256 ] 111 root - INFO - Checking Data Types of TSH: object, float64 
[ 2023-01-20 20:28:40,258 ] 118 root - INFO - Checking number of classes in in TSH column
: (0.2     116
1.3     105
1.1      97
1.4      91
1.5      80
       ... 
86        1
18.4      1
89        1
29        1
40        1
Name: TSH, Length: 287, dtype: int64, 1.10     22
1.00     21
1.30     21
1.50     21
0.02     19
         ..
28.00     1
0.33      1
7.60      1
31.00     1
0.97      1
Name: TSH, Length: 173, dtype: int64)
[ 2023-01-20 20:28:40,260 ] 111 root - INFO - Checking Data Types of TT4: object, float64 
[ 2023-01-20 20:28:40,262 ] 118 root - INFO - Checking number of classes in in TT4 column
: (101    71
93     67
98     63
103    63
102    59
       ..
289     1
240     1
43      1
34      1
258     1
Name: TT4, Length: 241, dtype: int64, 102.0    16
86.0     15
100.0    15
94.0     15
111.0    14
         ..
195.0     1
223.0     1
51.0      1
194.0     1
52.0      1
Name: TT4, Length: 155, dtype: int64)
[ 2023-01-20 20:28:40,263 ] 111 root - INFO - Checking Data Types of T4U: object, float64 
[ 2023-01-20 20:28:40,266 ] 118 root - INFO - Checking number of classes in in T4U column
: (0.99    95
0.9     93
1.01    91
1       90
0.92    89
        ..
1.84     1
0.57     1
2.03     1
1.97     1
0.25     1
Name: T4U, Length: 146, dtype: int64, 1.01    25
0.90    24
0.99    24
1.00    21
0.95    20
        ..
2.12     1
1.83     1
1.68     1
0.65     1
0.50     1
Name: T4U, Length: 105, dtype: int64)
[ 2023-01-20 20:28:40,267 ] 111 root - INFO - Checking Data Types of FTI: object, float64 
[ 2023-01-20 20:28:40,270 ] 118 root - INFO - Checking number of classes in in FTI column
: (100    73
93     70
114    65
98     64
107    64
       ..
349     1
221     1
187     1
39      1
227     1
Name: FTI, Length: 234, dtype: int64, 92.0     19
96.0     17
93.0     17
117.0    16
106.0    15
         ..
10.0      1
74.0      1
245.0     1
46.0      1
265.0     1
Name: FTI, Length: 142, dtype: int64)
[ 2023-01-20 20:28:40,271 ] 111 root - INFO - Checking Data Types of referral source: object, object 
[ 2023-01-20 20:28:40,272 ] 118 root - INFO - Checking number of classes in in referral source column
: (other    2201
SVI      1034
SVHC      386
STMW      112
SVHD       39
Name: referral source, dtype: int64, other    449
SVI      189
SVHC      80
STMW      30
SVHD       7
Name: referral source, dtype: int64)
[ 2023-01-20 20:28:40,273 ] 111 root - INFO - Checking Data Types of binaryClass: object, object 
[ 2023-01-20 20:28:40,275 ] 118 root - INFO - Checking number of classes in in binaryClass column
: (P    3481
N     291
Name: binaryClass, dtype: int64, P    697
N     58
Name: binaryClass, dtype: int64)
[ 2023-01-20 20:28:40,276 ] 169 root - INFO - Writing report in yaml file
[ 2023-01-20 20:28:40,286 ] 174 root - INFO - Data validation artifact: DataValidationArtifact(report_file_path='/config/workspace/artifact/01202023__202839/data_validation/report.yaml')
[ 2023-01-20 20:28:40,286 ] 24 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Feature Engineering <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-20 20:28:40,286 ] 88 root - INFO - Reading training and testing file
[ 2023-01-20 20:28:40,303 ] 93 root - INFO - Converting the categorical data to numerical
[ 2023-01-20 20:28:40,303 ] 39 root - INFO - Replacing 'f' to 0 and 't' to 1 in dataframe
[ 2023-01-20 20:28:40,338 ] 42 root - INFO - Manipulating data with one-hot encoding in 'referral source' column
[ 2023-01-20 20:28:40,344 ] 45 root - INFO - Replacing 'F' to 0 and 'M' to 1 'sex' column
[ 2023-01-20 20:28:40,347 ] 39 root - INFO - Replacing 'f' to 0 and 't' to 1 in dataframe
[ 2023-01-20 20:28:40,359 ] 42 root - INFO - Manipulating data with one-hot encoding in 'referral source' column
[ 2023-01-20 20:28:40,362 ] 45 root - INFO - Replacing 'F' to 0 and 'M' to 1 'sex' column
[ 2023-01-20 20:28:40,363 ] 98 root - INFO - Converting columns datatypes to float type
[ 2023-01-20 20:28:40,365 ] 104 root - INFO - Handling outlier and null value in 'age' and 'sex' column
[ 2023-01-20 20:28:40,370 ] 109 root - INFO - Selecting input feature for train and test dataframe
[ 2023-01-20 20:28:40,371 ] 112 root - INFO -        age  sex  on thyroxine  query on thyroxine  ...  referral source_SVHC  referral source_SVHD  referral source_SVI  referral source_other
0     65.0  0.0             1                   0  ...                     0                     0                    0                      1
1     62.0  0.0             0                   0  ...                     0                     0                    1                      0
2     27.0  0.0             0                   0  ...                     1                     0                    0                      0
3     80.0  0.0             0                   0  ...                     0                     0                    0                      1
4     28.0  0.0             0                   0  ...                     0                     0                    0                      1
...    ...  ...           ...                 ...  ...                   ...                   ...                  ...                    ...
3012  60.0  0.0             0                   0  ...                     0                     0                    0                      1
3013  25.0  0.0             0                   0  ...                     0                     0                    1                      0
3014  65.0  0.0             1                   0  ...                     0                     0                    0                      1
3015  73.0  0.0             1                   0  ...                     0                     0                    0                      1
3016  75.0  1.0             0                   0  ...                     0                     1                    0                      0

[3017 rows x 33 columns]
[ 2023-01-20 20:28:40,413 ] 115 root - INFO - Selecting target feature for train and test dataframe
[ 2023-01-20 20:28:40,414 ] 120 root - INFO - Encoding the target feature values
[ 2023-01-20 20:28:40,416 ] 127 root - INFO - Target feature label encoded values: [1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 0 0 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 0 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1
 0 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1
 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 0 1 0 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 0 1 1 0 1 0 1 1 1 1 1 1 1 0 1 0 0 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 0 1 1 1 1 1 0 1 1 1 0
 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1
 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 0 1 1 1 1 0 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1]
[ 2023-01-20 20:28:42,155 ] 136 root - INFO - [[65.  0.  1. ...  0.  0.  1.]
 [62.  0.  0. ...  0.  1.  0.]
 [27.  0.  0. ...  0.  0.  0.]
 ...
 [65.  0.  1. ...  0.  0.  1.]
 [73.  0.  1. ...  0.  0.  1.]
 [75.  1.  0. ...  1.  0.  0.]]
[ 2023-01-20 20:28:42,156 ] 140 root - INFO - Before resampling in training set Input: (3017, 32) Target:(3017,)
[ 2023-01-20 20:28:42,580 ] 142 root - INFO - After resampling in training set Input: (5560, 32) Target:(5560,)
[ 2023-01-20 20:28:42,580 ] 144 root - INFO - Before resampling in testing set Input: (755, 32) Target:(755,)
[ 2023-01-20 20:28:42,664 ] 146 root - INFO - After resampling in testing set Input: (1392, 32) Target:(1392,)
[ 2023-01-20 20:28:42,670 ] 66 root - INFO - Entered the save_object method of utils
[ 2023-01-20 20:28:42,674 ] 70 root - INFO - Exited the save_object method of utils
[ 2023-01-20 20:28:42,674 ] 66 root - INFO - Entered the save_object method of utils
[ 2023-01-20 20:28:42,675 ] 70 root - INFO - Exited the save_object method of utils
[ 2023-01-20 20:28:42,675 ] 168 root - INFO - Data transformation object FeatureEngineeringArtifact(imputer_object_path='/config/workspace/artifact/01202023__202839/feature_engineering/imputer/knn_imputer.pkl', transformed_train_path='/config/workspace/artifact/01202023__202839/feature_engineering/transformed/train.npz', transformed_test_path='/config/workspace/artifact/01202023__202839/feature_engineering/transformed/test.npz', target_encoder_path='/config/workspace/artifact/01202023__202839/feature_engineering/target_encoder/target_encoder.pkl')
[ 2023-01-20 20:28:42,675 ] 17 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Model Trainer <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-20 20:28:42,675 ] 67 root - INFO - Loading train and test array.
[ 2023-01-20 20:28:42,682 ] 71 root - INFO - Splitting input and target feature from both train and test arr.
[ 2023-01-20 20:28:42,682 ] 80 root - INFO - Train the model
[ 2023-01-20 20:28:53,204 ] 84 root - INFO - Calculating f1 train score
[ 2023-01-20 20:28:53,218 ] 89 root - INFO - Calculating f1 test score
[ 2023-01-20 20:28:53,226 ] 93 root - INFO - train score:1.0 and tests score 0.9985632183908046
[ 2023-01-20 20:28:53,226 ] 94 root - INFO - Checking if our model is a good model or not
[ 2023-01-20 20:28:53,226 ] 99 root - INFO - Checking if our model is overfiiting or not
[ 2023-01-20 20:28:53,226 ] 107 root - INFO - Saving mode object
[ 2023-01-20 20:28:53,226 ] 66 root - INFO - Entered the save_object method of utils
[ 2023-01-20 20:28:53,232 ] 70 root - INFO - Exited the save_object method of utils
[ 2023-01-20 20:28:53,232 ] 111 root - INFO - Prepare the artifact
[ 2023-01-20 20:28:53,233 ] 114 root - INFO - Model trainer artifact: ModelTrainerArtifact(model_path='/config/workspace/artifact/01202023__202839/model_trainer/model/model.pkl', f1_train_score=1.0, f1_test_score=0.9985632183908046)
[ 2023-01-20 20:28:53,233 ] 21 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  Model Evaluation <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-20 20:28:53,234 ] 36 root - INFO - If saved model folder has model then we will compare which model is best, Trained model from artifact folder or the model from saved model folder
[ 2023-01-20 20:28:53,234 ] 46 root - INFO - Finding location of target encoder
[ 2023-01-20 20:28:53,234 ] 51 root - INFO - Previous trained objects of model and target encoder
[ 2023-01-20 20:28:53,243 ] 56 root - INFO - Currently trained model objects

[ 2023-01-22 21:22:02,447 ] 20 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Data Ingestion <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-22 21:22:02,447 ] 31 root - INFO - Exporting collection data as pandas dataframe
[ 2023-01-22 21:22:02,447 ] 22 root - INFO - Reading data from database: HealthCare and collection: Thyroid
[ 2023-01-22 21:22:02,605 ] 24 root - INFO - Found columns: Index(['_id', 'age', 'sex', 'on thyroxine', 'query on thyroxine',
       'on antithyroid medication', 'sick', 'pregnant', 'thyroid surgery',
       'I131 treatment', 'query hypothyroid', 'query hyperthyroid', 'lithium',
       'goitre', 'tumor', 'hypopituitary', 'psych', 'TSH measured', 'TSH',
       'T3 measured', 'T3', 'TT4 measured', 'TT4', 'T4U measured', 'T4U',
       'FTI measured', 'FTI', 'TBG measured', 'TBG', 'referral source',
       'binaryClass'],
      dtype='object')
[ 2023-01-22 21:22:02,606 ] 26 root - INFO - Dropping column: _id 
[ 2023-01-22 21:22:02,608 ] 28 root - INFO - Row and columns in df: (3772, 30)
[ 2023-01-22 21:22:02,609 ] 37 root - INFO - Replacing '?' value to np.NAN
[ 2023-01-22 21:22:02,613 ] 42 root - INFO - Save data in feature store
[ 2023-01-22 21:22:02,614 ] 44 root - INFO - Create feature store folder if not available
[ 2023-01-22 21:22:02,614 ] 48 root - INFO - Save df to feature store folder
[ 2023-01-22 21:22:02,654 ] 53 root - INFO - split dataset into train and test set
[ 2023-01-22 21:22:02,659 ] 57 root - INFO - create dataset directory folder if not available
[ 2023-01-22 21:22:02,659 ] 62 root - INFO - Saving train df and test df to dataset folder
[ 2023-01-22 21:22:02,695 ] 74 root - INFO - Data ingestion artifact: DataIngestionArtifact(feature_store_file_path='/config/workspace/artifact/01222023__212202/data_ingestion/feature_store/thyroid.csv', train_file_path='/config/workspace/artifact/01222023__212202/data_ingestion/dataset/train.csv', test_file_path='/config/workspace/artifact/01222023__212202/data_ingestion/dataset/test.csv')
[ 2023-01-22 21:22:02,697 ] 21 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Data Validation <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-22 21:22:02,698 ] 130 root - INFO - Reading base dataframe
[ 2023-01-22 21:22:02,734 ] 133 root - INFO - Replace ? value in base df
[ 2023-01-22 21:22:02,734 ] 135 root - INFO - Drop null values colums from base df
[ 2023-01-22 21:22:02,751 ] 42 root - INFO - selecting column name which contains null above to 0.2
[ 2023-01-22 21:22:02,751 ] 45 root - INFO - Columns to drop: ['T3', 'TBG']
[ 2023-01-22 21:22:02,753 ] 138 root - INFO - Reading train dataframe
[ 2023-01-22 21:22:02,764 ] 140 root - INFO - Reading test dataframe
[ 2023-01-22 21:22:02,770 ] 143 root - INFO - Drop null values colums from train df
[ 2023-01-22 21:22:02,781 ] 42 root - INFO - selecting column name which contains null above to 0.2
[ 2023-01-22 21:22:02,781 ] 45 root - INFO - Columns to drop: ['T3', 'TBG']
[ 2023-01-22 21:22:02,782 ] 145 root - INFO - Drop null values colums from test df
[ 2023-01-22 21:22:02,786 ] 42 root - INFO - selecting column name which contains null above to 0.2
[ 2023-01-22 21:22:02,786 ] 45 root - INFO - Columns to drop: ['TBG']
[ 2023-01-22 21:22:02,787 ] 148 root - INFO - Drop unnecessary columns from base df
[ 2023-01-22 21:22:02,787 ] 66 root - INFO - UnnecessaColumns dropped: ['TSH measured', 'T3 measured', 'TT4 measured', 'T4U measured', 'FTI measured', 'TBG measured', 'referral source', 'query on thyroxine', 'query hypothyroid', 'query hyperthyroid']
[ 2023-01-22 21:22:02,789 ] 150 root - INFO - Drop unnecessary columns from train df
[ 2023-01-22 21:22:02,789 ] 66 root - INFO - UnnecessaColumns dropped: ['TSH measured', 'T3 measured', 'TT4 measured', 'T4U measured', 'FTI measured', 'TBG measured', 'referral source', 'query on thyroxine', 'query hypothyroid', 'query hyperthyroid']
[ 2023-01-22 21:22:02,791 ] 152 root - INFO - Drop unnecessary columns from test df
[ 2023-01-22 21:22:02,791 ] 66 root - INFO - UnnecessaColumns dropped: ['TSH measured', 'T3 measured', 'TT4 measured', 'T4U measured', 'FTI measured', 'TBG measured', 'referral source', 'query on thyroxine', 'query hypothyroid', 'query hyperthyroid']
[ 2023-01-22 21:22:02,793 ] 155 root - INFO - Is all required columns present in train df
[ 2023-01-22 21:22:02,793 ] 157 root - INFO - Is all required columns present in test df
[ 2023-01-22 21:22:02,793 ] 161 root - INFO - As all column are available in train df hence detecting data drift in train dataframe
[ 2023-01-22 21:22:02,793 ] 110 root - INFO - Checking Data Types of 'age': object, float64 
[ 2023-01-22 21:22:02,797 ] 117 root - INFO - Checking number of classes in in age column
: (59     95
60     91
70     90
73     81
55     81
       ..
10      1
4       1
5       1
455     1
6       1
Name: age, Length: 93, dtype: int64, 60.0     82
59.0     74
55.0     71
70.0     69
63.0     67
         ..
4.0       1
5.0       1
6.0       1
93.0      1
455.0     1
Name: age, Length: 93, dtype: int64)
[ 2023-01-22 21:22:02,798 ] 110 root - INFO - Checking Data Types of 'sex': object, object 
[ 2023-01-22 21:22:02,800 ] 117 root - INFO - Checking number of classes in in sex column
: (F    2480
M    1142
Name: sex, dtype: int64, F    1990
M     904
Name: sex, dtype: int64)
[ 2023-01-22 21:22:02,801 ] 110 root - INFO - Checking Data Types of 'on thyroxine': object, object 
[ 2023-01-22 21:22:02,803 ] 117 root - INFO - Checking number of classes in in on thyroxine column
: (f    3308
t     464
Name: on thyroxine, dtype: int64, f    2640
t     377
Name: on thyroxine, dtype: int64)
[ 2023-01-22 21:22:02,804 ] 110 root - INFO - Checking Data Types of 'on antithyroid medication': object, object 
[ 2023-01-22 21:22:02,805 ] 117 root - INFO - Checking number of classes in in on antithyroid medication column
: (f    3729
t      43
Name: on antithyroid medication, dtype: int64, f    2985
t      32
Name: on antithyroid medication, dtype: int64)
[ 2023-01-22 21:22:02,807 ] 110 root - INFO - Checking Data Types of 'sick': object, object 
[ 2023-01-22 21:22:02,808 ] 117 root - INFO - Checking number of classes in in sick column
: (f    3625
t     147
Name: sick, dtype: int64, f    2897
t     120
Name: sick, dtype: int64)
[ 2023-01-22 21:22:02,810 ] 110 root - INFO - Checking Data Types of 'pregnant': object, object 
[ 2023-01-22 21:22:02,811 ] 117 root - INFO - Checking number of classes in in pregnant column
: (f    3719
t      53
Name: pregnant, dtype: int64, f    2971
t      46
Name: pregnant, dtype: int64)
[ 2023-01-22 21:22:02,813 ] 110 root - INFO - Checking Data Types of 'thyroid surgery': object, object 
[ 2023-01-22 21:22:02,814 ] 117 root - INFO - Checking number of classes in in thyroid surgery column
: (f    3719
t      53
Name: thyroid surgery, dtype: int64, f    2973
t      44
Name: thyroid surgery, dtype: int64)
[ 2023-01-22 21:22:02,815 ] 110 root - INFO - Checking Data Types of 'I131 treatment': object, object 
[ 2023-01-22 21:22:02,817 ] 117 root - INFO - Checking number of classes in in I131 treatment column
: (f    3713
t      59
Name: I131 treatment, dtype: int64, f    2969
t      48
Name: I131 treatment, dtype: int64)
[ 2023-01-22 21:22:02,818 ] 110 root - INFO - Checking Data Types of 'lithium': object, object 
[ 2023-01-22 21:22:02,820 ] 117 root - INFO - Checking number of classes in in lithium column
: (f    3754
t      18
Name: lithium, dtype: int64, f    3002
t      15
Name: lithium, dtype: int64)
[ 2023-01-22 21:22:02,821 ] 110 root - INFO - Checking Data Types of 'goitre': object, object 
[ 2023-01-22 21:22:02,822 ] 117 root - INFO - Checking number of classes in in goitre column
: (f    3738
t      34
Name: goitre, dtype: int64, f    2987
t      30
Name: goitre, dtype: int64)
[ 2023-01-22 21:22:02,824 ] 110 root - INFO - Checking Data Types of 'tumor': object, object 
[ 2023-01-22 21:22:02,825 ] 117 root - INFO - Checking number of classes in in tumor column
: (f    3676
t      96
Name: tumor, dtype: int64, f    2938
t      79
Name: tumor, dtype: int64)
[ 2023-01-22 21:22:02,827 ] 110 root - INFO - Checking Data Types of 'hypopituitary': object, object 
[ 2023-01-22 21:22:02,828 ] 117 root - INFO - Checking number of classes in in hypopituitary column
: (f    3771
t       1
Name: hypopituitary, dtype: int64, f    3016
t       1
Name: hypopituitary, dtype: int64)
[ 2023-01-22 21:22:02,830 ] 110 root - INFO - Checking Data Types of 'psych': object, object 
[ 2023-01-22 21:22:02,831 ] 117 root - INFO - Checking number of classes in in psych column
: (f    3588
t     184
Name: psych, dtype: int64, f    2867
t     150
Name: psych, dtype: int64)
[ 2023-01-22 21:22:02,832 ] 110 root - INFO - Checking Data Types of 'TSH': object, float64 
[ 2023-01-22 21:22:02,835 ] 117 root - INFO - Checking number of classes in in TSH column
: (0.2     116
1.3     105
1.1      97
1.4      91
1.5      80
       ... 
86        1
18.4      1
89        1
29        1
40        1
Name: TSH, Length: 287, dtype: int64, 0.2      90
1.1      85
1.3      78
1.4      69
1.6      67
         ..
89.0      1
61.0      1
530.0     1
99.0      1
50.0      1
Name: TSH, Length: 277, dtype: int64)
[ 2023-01-22 21:22:02,836 ] 110 root - INFO - Checking Data Types of 'TT4': object, float64 
[ 2023-01-22 21:22:02,839 ] 117 root - INFO - Checking number of classes in in TT4 column
: (101    71
93     67
98     63
103    63
102    59
       ..
289     1
240     1
43      1
34      1
258     1
Name: TT4, Length: 241, dtype: int64, 98.0     52
93.0     51
103.0    51
102.0    50
101.0    48
         ..
258.0     1
24.0      1
196.0     1
246.0     1
9.5       1
Name: TT4, Length: 233, dtype: int64)
[ 2023-01-22 21:22:02,840 ] 110 root - INFO - Checking Data Types of 'T4U': object, float64 
[ 2023-01-22 21:22:02,843 ] 117 root - INFO - Checking number of classes in in T4U column
: (0.99    95
0.9     93
1.01    91
1       90
0.92    89
        ..
1.84     1
0.57     1
2.03     1
1.97     1
0.25     1
Name: T4U, Length: 146, dtype: int64, 0.920    78
1.010    77
0.990    76
0.950    74
0.970    72
         ..
0.360     1
2.030     1
1.800     1
0.944     1
1.760     1
Name: T4U, Length: 143, dtype: int64)
[ 2023-01-22 21:22:02,844 ] 110 root - INFO - Checking Data Types of 'FTI': object, float64 
[ 2023-01-22 21:22:02,847 ] 117 root - INFO - Checking number of classes in in FTI column
: (100    73
93     70
114    65
98     64
107    64
       ..
349     1
221     1
187     1
39      1
227     1
Name: FTI, Length: 234, dtype: int64, 100.0    60
101.0    53
93.0     52
98.0     52
107.0    52
         ..
185.0     1
283.0     1
291.0     1
281.0     1
244.0     1
Name: FTI, Length: 223, dtype: int64)
[ 2023-01-22 21:22:02,848 ] 110 root - INFO - Checking Data Types of 'binaryClass': object, object 
[ 2023-01-22 21:22:02,849 ] 117 root - INFO - Checking number of classes in in binaryClass column
: (P    3481
N     291
Name: binaryClass, dtype: int64, P    2787
N     230
Name: binaryClass, dtype: int64)
[ 2023-01-22 21:22:02,851 ] 164 root - INFO - As all column are available in test df hence detecting data drift test dataframe
[ 2023-01-22 21:22:02,851 ] 110 root - INFO - Checking Data Types of 'age': object, int64 
[ 2023-01-22 21:22:02,853 ] 117 root - INFO - Checking number of classes in in age column
: (59     95
60     91
70     90
73     81
55     81
       ..
10      1
4       1
5       1
455     1
6       1
Name: age, Length: 93, dtype: int64, 72    26
58    22
70    21
59    21
68    19
      ..
8      1
2      1
93     1
89     1
11     1
Name: age, Length: 83, dtype: int64)
[ 2023-01-22 21:22:02,854 ] 110 root - INFO - Checking Data Types of 'sex': object, object 
[ 2023-01-22 21:22:02,856 ] 117 root - INFO - Checking number of classes in in sex column
: (F    2480
M    1142
Name: sex, dtype: int64, F    490
M    238
Name: sex, dtype: int64)
[ 2023-01-22 21:22:02,857 ] 110 root - INFO - Checking Data Types of 'on thyroxine': object, object 
[ 2023-01-22 21:22:02,858 ] 117 root - INFO - Checking number of classes in in on thyroxine column
: (f    3308
t     464
Name: on thyroxine, dtype: int64, f    668
t     87
Name: on thyroxine, dtype: int64)
[ 2023-01-22 21:22:02,859 ] 110 root - INFO - Checking Data Types of 'on antithyroid medication': object, object 
[ 2023-01-22 21:22:02,861 ] 117 root - INFO - Checking number of classes in in on antithyroid medication column
: (f    3729
t      43
Name: on antithyroid medication, dtype: int64, f    744
t     11
Name: on antithyroid medication, dtype: int64)
[ 2023-01-22 21:22:02,862 ] 110 root - INFO - Checking Data Types of 'sick': object, object 
[ 2023-01-22 21:22:02,863 ] 117 root - INFO - Checking number of classes in in sick column
: (f    3625
t     147
Name: sick, dtype: int64, f    728
t     27
Name: sick, dtype: int64)
[ 2023-01-22 21:22:02,864 ] 110 root - INFO - Checking Data Types of 'pregnant': object, object 
[ 2023-01-22 21:22:02,866 ] 117 root - INFO - Checking number of classes in in pregnant column
: (f    3719
t      53
Name: pregnant, dtype: int64, f    748
t      7
Name: pregnant, dtype: int64)
[ 2023-01-22 21:22:02,867 ] 110 root - INFO - Checking Data Types of 'thyroid surgery': object, object 
[ 2023-01-22 21:22:02,868 ] 117 root - INFO - Checking number of classes in in thyroid surgery column
: (f    3719
t      53
Name: thyroid surgery, dtype: int64, f    746
t      9
Name: thyroid surgery, dtype: int64)
[ 2023-01-22 21:22:02,869 ] 110 root - INFO - Checking Data Types of 'I131 treatment': object, object 
[ 2023-01-22 21:22:02,871 ] 117 root - INFO - Checking number of classes in in I131 treatment column
: (f    3713
t      59
Name: I131 treatment, dtype: int64, f    744
t     11
Name: I131 treatment, dtype: int64)
[ 2023-01-22 21:22:02,872 ] 110 root - INFO - Checking Data Types of 'lithium': object, object 
[ 2023-01-22 21:22:02,873 ] 117 root - INFO - Checking number of classes in in lithium column
: (f    3754
t      18
Name: lithium, dtype: int64, f    752
t      3
Name: lithium, dtype: int64)
[ 2023-01-22 21:22:02,874 ] 110 root - INFO - Checking Data Types of 'goitre': object, object 
[ 2023-01-22 21:22:02,876 ] 117 root - INFO - Checking number of classes in in goitre column
: (f    3738
t      34
Name: goitre, dtype: int64, f    751
t      4
Name: goitre, dtype: int64)
[ 2023-01-22 21:22:02,877 ] 110 root - INFO - Checking Data Types of 'tumor': object, object 
[ 2023-01-22 21:22:02,878 ] 117 root - INFO - Checking number of classes in in tumor column
: (f    3676
t      96
Name: tumor, dtype: int64, f    738
t     17
Name: tumor, dtype: int64)
[ 2023-01-22 21:22:02,879 ] 110 root - INFO - Checking Data Types of 'hypopituitary': object, object 
[ 2023-01-22 21:22:02,881 ] 117 root - INFO - Checking number of classes in in hypopituitary column
: (f    3771
t       1
Name: hypopituitary, dtype: int64, f    755
Name: hypopituitary, dtype: int64)
[ 2023-01-22 21:22:02,882 ] 110 root - INFO - Checking Data Types of 'psych': object, object 
[ 2023-01-22 21:22:02,884 ] 117 root - INFO - Checking number of classes in in psych column
: (f    3588
t     184
Name: psych, dtype: int64, f    721
t     34
Name: psych, dtype: int64)
[ 2023-01-22 21:22:02,885 ] 110 root - INFO - Checking Data Types of 'TSH': object, float64 
[ 2023-01-22 21:22:02,887 ] 117 root - INFO - Checking number of classes in in TSH column
: (0.2     116
1.3     105
1.1      97
1.4      91
1.5      80
       ... 
86        1
18.4      1
89        1
29        1
40        1
Name: TSH, Length: 287, dtype: int64, 1.30     27
0.20     26
1.40     22
1.80     21
1.00     19
         ..
4.30      1
0.64      1
36.00     1
21.00     1
0.46      1
Name: TSH, Length: 169, dtype: int64)
[ 2023-01-22 21:22:02,889 ] 110 root - INFO - Checking Data Types of 'TT4': object, float64 
[ 2023-01-22 21:22:02,891 ] 117 root - INFO - Checking number of classes in in TT4 column
: (101    71
93     67
98     63
103    63
102    59
       ..
289     1
240     1
43      1
34      1
258     1
Name: TT4, Length: 241, dtype: int64, 101.0    23
93.0     16
82.0     16
120.0    16
100.0    14
         ..
192.0     1
197.0     1
33.0      1
213.0     1
5.8       1
Name: TT4, Length: 150, dtype: int64)
[ 2023-01-22 21:22:02,892 ] 110 root - INFO - Checking Data Types of 'T4U': object, float64 
[ 2023-01-22 21:22:02,895 ] 117 root - INFO - Checking number of classes in in T4U column
: (0.99    95
0.9     93
1.01    91
1       90
0.92    89
        ..
1.84     1
0.57     1
2.03     1
1.97     1
0.25     1
Name: T4U, Length: 146, dtype: int64, 0.90    25
0.96    24
0.93    24
0.98    21
1.05    20
        ..
0.66     1
1.52     1
2.01     1
1.41     1
1.31     1
Name: T4U, Length: 95, dtype: int64)
[ 2023-01-22 21:22:02,896 ] 110 root - INFO - Checking Data Types of 'FTI': object, float64 
[ 2023-01-22 21:22:02,899 ] 117 root - INFO - Checking number of classes in in FTI column
: (100    73
93     70
114    65
98     64
107    64
       ..
349     1
221     1
187     1
39      1
227     1
Name: FTI, Length: 234, dtype: int64, 93.0     18
96.0     18
92.0     17
104.0    16
114.0    15
         ..
182.0     1
49.0      1
216.0     1
186.0     1
56.0      1
Name: FTI, Length: 143, dtype: int64)
[ 2023-01-22 21:22:02,900 ] 110 root - INFO - Checking Data Types of 'binaryClass': object, object 
[ 2023-01-22 21:22:02,901 ] 117 root - INFO - Checking number of classes in in binaryClass column
: (P    3481
N     291
Name: binaryClass, dtype: int64, P    694
N     61
Name: binaryClass, dtype: int64)
[ 2023-01-22 21:22:02,902 ] 168 root - INFO - Writing report in yaml file
[ 2023-01-22 21:22:02,912 ] 173 root - INFO - Data validation artifact: DataValidationArtifact(report_file_path='/config/workspace/artifact/01222023__212202/data_validation/report.yaml')
[ 2023-01-22 21:22:02,913 ] 25 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Feature Engineering <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-22 21:22:02,913 ] 84 root - INFO - Reading training and testing file
[ 2023-01-22 21:22:02,930 ] 89 root - INFO - Converting the categorical data to numerical
[ 2023-01-22 21:22:02,930 ] 39 root - INFO - Replacing 'f' to 0 and 't' to 1 in dataframe
[ 2023-01-22 21:22:02,964 ] 42 root - INFO - Replacing 'F' to 0 and 'M' to 1 'sex' column
[ 2023-01-22 21:22:02,966 ] 39 root - INFO - Replacing 'f' to 0 and 't' to 1 in dataframe
[ 2023-01-22 21:22:02,977 ] 42 root - INFO - Replacing 'F' to 0 and 'M' to 1 'sex' column
[ 2023-01-22 21:22:02,978 ] 94 root - INFO - Converting columns datatypes to float type
[ 2023-01-22 21:22:02,981 ] 100 root - INFO - Handling outlier and null value in 'age' and 'sex' column
[ 2023-01-22 21:22:02,985 ] 105 root - INFO - Selecting input feature for train and test dataframe
[ 2023-01-22 21:22:02,987 ] 110 root - INFO - Selecting target feature for train and test dataframe
[ 2023-01-22 21:22:02,987 ] 115 root - INFO - Encoding the target feature values
[ 2023-01-22 21:22:02,989 ] 122 root - INFO - Target feature label encoded values: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 0 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1
 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1
 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 1
 1 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 0 1 1 0 0 1 1 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1
 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 0 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1
 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1]
[ 2023-01-22 21:22:04,665 ] 134 root - INFO - Before resampling in training set Input: (3017, 27) Target:(3017,)
[ 2023-01-22 21:22:05,078 ] 136 root - INFO - After resampling in training set Input: (5566, 27) Target:(5566,)
[ 2023-01-22 21:22:05,079 ] 138 root - INFO - Before resampling in testing set Input: (755, 27) Target:(755,)
[ 2023-01-22 21:22:05,156 ] 140 root - INFO - After resampling in testing set Input: (1386, 27) Target:(1386,)
[ 2023-01-22 21:22:05,162 ] 68 root - INFO - Entered the save_object method of utils
[ 2023-01-22 21:22:05,165 ] 72 root - INFO - Exited the save_object method of utils
[ 2023-01-22 21:22:05,166 ] 68 root - INFO - Entered the save_object method of utils
[ 2023-01-22 21:22:05,166 ] 72 root - INFO - Exited the save_object method of utils
[ 2023-01-22 21:22:05,166 ] 162 root - INFO - Data transformation object FeatureEngineeringArtifact(knn_imputer_object_path='/config/workspace/artifact/01222023__212202/feature_engineering/imputer/knn_imputer.pkl', transformed_train_path='/config/workspace/artifact/01222023__212202/feature_engineering/transformed/train.npz', transformed_test_path='/config/workspace/artifact/01222023__212202/feature_engineering/transformed/test.npz', target_encoder_path='/config/workspace/artifact/01222023__212202/feature_engineering/target_encoder/target_encoder.pkl')
[ 2023-01-22 21:22:05,167 ] 20 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Model Trainer <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-22 21:22:05,167 ] 69 root - INFO - Loading train and test array.
[ 2023-01-22 21:22:05,173 ] 73 root - INFO - Splitting input and target feature from both train and test arr.
[ 2023-01-22 21:22:05,173 ] 82 root - INFO - Train the model
[ 2023-01-22 21:22:15,812 ] 86 root - INFO - Calculating f1 train score
[ 2023-01-22 21:22:15,827 ] 91 root - INFO - Calculating f1 test score
[ 2023-01-22 21:22:15,835 ] 95 root - INFO - train score:1.0 and tests score 0.9928366762177651
[ 2023-01-22 21:22:15,835 ] 96 root - INFO - Checking if our model is a good model or not
[ 2023-01-22 21:22:15,835 ] 101 root - INFO - Checking if our model is overfiiting or not
[ 2023-01-22 21:22:15,835 ] 109 root - INFO - Saving mode object
[ 2023-01-22 21:22:15,835 ] 68 root - INFO - Entered the save_object method of utils
[ 2023-01-22 21:22:15,842 ] 72 root - INFO - Exited the save_object method of utils
[ 2023-01-22 21:22:15,842 ] 113 root - INFO - Prepare the artifact
[ 2023-01-22 21:22:15,843 ] 116 root - INFO - Model trainer artifact: ModelTrainerArtifact(model_path='/config/workspace/artifact/01222023__212202/model_trainer/model/model.pkl', f1_train_score=1.0, f1_test_score=0.9928366762177651)
[ 2023-01-22 21:22:15,843 ] 25 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  Model Evaluation <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-22 21:22:15,843 ] 26 root - INFO - ___________________________________________________________________________________________________________
[ 2023-01-22 21:22:15,844 ] 25 root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Feature Engineering <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[ 2023-01-22 21:22:15,844 ] 42 root - INFO - ___________________________________________________________________________________________________________
[ 2023-01-22 21:22:15,844 ] 43 root - INFO - If saved model folder has model then we will compare which model is best, Trained model from artifact folder or the model from saved model folder
[ 2023-01-22 21:22:15,844 ] 53 root - INFO - Finding location of knn_imputer, model and target encoder
[ 2023-01-22 21:22:15,845 ] 59 root - INFO - Previous trained objects of knn_imputer, model and target encoder
[ 2023-01-22 21:22:15,854 ] 65 root - INFO - Currently trained model objects
[ 2023-01-22 21:22:15,876 ] 39 root - INFO - Replacing 'f' to 0 and 't' to 1 in dataframe
[ 2023-01-22 21:22:15,888 ] 42 root - INFO - Replacing 'F' to 0 and 'M' to 1 'sex' column
[ 2023-01-22 21:22:16,199 ] 91 root - INFO - Accuracy using previous trained model: 1.0
[ 2023-01-22 21:22:16,200 ] 39 root - INFO - Replacing 'f' to 0 and 't' to 1 in dataframe
[ 2023-01-22 21:22:16,211 ] 42 root - INFO - Replacing 'F' to 0 and 'M' to 1 'sex' column
[ 2023-01-22 21:22:16,442 ] 107 root - INFO - Accuracy using current trained model: 0.9985611510791367
[ 2023-01-22 21:22:16,442 ] 109 root - INFO - Current trained model is not better than previous model
